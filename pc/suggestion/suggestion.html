<link rel="stylesheet" type="text/css" href="../reset.css" />
<link rel="stylesheet" type="text/css" href="jquery.autocomplete.css" />
<link rel="stylesheet" type="text/css" href="suggestion.css" />
<div class="searchbox">            
    <img src="/assets/img/logo.png" class="logo"/>
    <div class="iptbox">
        <em></em>
        <input type="text" id="searchipt"/>
        <button id="searchbtn">搜索</button>
    </div>                
</div>
<p style="margin-top: 80px;">输入关键词2</p>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="jquery.autocomplete.js"></script>
<script type="text/javascript">
	//初始化suggestion
	$('#searchipt').autocomplete({
	    dropdownStyle: {width: "300px", top: "45px"},
	    onkeyPress: function(val){
	        var query = $.trim(val);
	        if(query.length != 0) {
	            $(".iptbox").addClass("del");
	        }else {
	            $(".iptbox").removeClass("del");                      
	        }
	    },
	    onEnter: function(val){
	        var query = $.trim(val);
	        amap.fwd("/search?" + $.param({
	            query : query
	        }));
	    },
	    onFocus: function(val) {
	        var query = $.trim(val);
	        if(query.length != 0) {
	            $(".iptbox").addClass("del");
	        }  
	    },
	    onBlur: function() {
	        setTimeout(function(){
	            $(".iptbox").removeClass("del");
	        }, 200);
	    },
	    openOnFocus: true,
	    appendMethod: "replace",
	    source:[
	        function(word, add){                
	            $.ajax({
	                url: "data.js?city=110000&words=" + word,
	                method: 'get',
	                dataType: "json",
	                success: function(msg){
	                    if(!msg.data || !msg.data.tip_list) {
	                        return false;
	                    }
	                    var tips = msg.data.tip_list,
	                        messArray = [];
	                    for(var i = 0; i < tips.length; i++){
	                        messArray.push(tips[i].tip);
	                    }
	                    add(messArray);
	                }
	            });
	        }
	    ]
	}); 

	//点击删除按钮,清空输入框、删除按钮消失
	$(".iptbox em").click(function(){
	    if($(this).parent().hasClass("del")){
	        $("#searchipt").val("");
	        $(this).parent().removeClass("del")        
	        $("#searchipt").focus();
	    }
	});

	$(window).load(function(){
	    $("#searchipt").focus();
	})
</script>